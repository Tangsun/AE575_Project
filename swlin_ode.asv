function dxdt = swlin_ode(t, x, A, B, P)
    cost_i(i) = zeros(1, 3);
    for i = 1: 3
        lambda = P{i}*x;
        cost_i(i) = lambda'*((A{i} - B{i}*inv(R)*S)*x - 0.5*B{i}*inv(R)*B{i}'*lambda);
    end
    lambda = P*x;
    u = -inv(R)*(S*x + B'*lambda);
    dxdt = A*x + B*u;
end